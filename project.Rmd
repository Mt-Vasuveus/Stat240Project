---
author: "Vasu Janjrukia, Sarah Larson, Jaehyun Park, Justin Wang"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE,
                      warning = FALSE, error = TRUE, fig.height = 3)
library(tidyverse)
library(lubridate)
library(kableExtra)
library(broman)
source("../scripts/viridis.R")
source("../scripts/ggprob.R")
theme_set(theme_minimal())
```

```{r, include=FALSE}

attendance_orig = read_csv("School_Attendance_by_Student_Group_and_District__2021-2022.csv",
                           name_repair = make.names) %>% 
  select(-Category, -Reporting.period, -Date.update) %>% 
  rename(district_code = District.code,
         district_name = District.name,
         group = Student.group) %>% 
  pivot_longer(cols = -c(district_code, district_name, group), 
               names_pattern = "^X(\\d{4}\\.\\d{4})\\.(\\w+\\.\\w+).*$", 
               names_to = c("year", "name")) %>% 
  pivot_wider(names_from = "name", values_from = "value") %>% 
  rename(count = student.count,
         attendance_rate = attendance.rate)

attendance_orig$year = attendance_orig$year %>% str_replace("\\.", "-")

attendance = attendance_orig %>% 
  filter(group == "Free/Reduced Price Meal Eligible" |
           group == "All Students") %>% 
  filter(!is.na(count) & !is.na(attendance_rate))

```


# Introduction

The COVID-19 pandemic had far reaching impacts on our daily lives. One area that was greatly affected was education. The main goal of our research was to examine if any groups of students were disproportionately affected during the pandemic. In particular, we will be examining attendance rates between students who qualified for free or reduced price lunch against the attendance rates of the student body as a whole. We believe that the effects of the COVID-19 pandemic has had an UNEQUAL/EQUAL affect on students who qualify for food assistance, resulting in them missing a greater amount of school than average.

-[X] The opening sentence or sentences should draw the reader into your report by providing high-level motivation for the analysis. 
-[X] Describe the question or questions of interest and the motivation for the analysis.
-[X] Conclude the introduction with a thesis statement.
-[] A thesis statement comprises one or two declarative sentences that summarize the main point of the report and clearly makes an assertion and communicates to the reader the position the authors have taken on the topic.


# Background

This data set was collected by State of Connecticut Department of Education^[https://catalog.data.gov/dataset/school-attendance-by-student-group-and-district-2021-2022] to measure attendance rates for all of the school districts in the state. Data for certain groups were suppressed to either maintain anonymity or to prevent misinterpretation of statistics from very small sample sizes as being as representative as those from larger ones. As a result, schools that didn't have published statistics on the attendance of students who qualified for free/reduced price meals were excluded. In the state of Connecticut, students who qualify for free/ reduced price meals belong to households eligible for SNAP or TFA benefits^[https://portal.ct.gov/-/media/SDE/Nutrition/NSLP/Forms/FreeRed/Parent_Letter_FAQ_Free_Reduced_Meals_NSLP_SBP.docx], which mostly includes households at or under two times the Federal Poverty Level.

-[X] Describe the data set, how it was collected, what the variables mean.
-[X] Cite the source of your data.
-[] Describe any background information needed to better comprehend the question or questions you are posing and how the data relate to the question.
-[X] Describe any unusual factors which may affect interpretation of results.
-[] Describe what you intend to do in the rest of the report.

# Analysis

Below we can see the median attendance rates for students, split into 

```{r,include=FALSE}

attendance_rate_mean = attendance %>% 
  group_by(year, group) %>% 
  summarise(mean = mean(attendance_rate))


attendance %>% ggplot(aes(x = attendance_rate)) +
  facet_grid(cols = vars(year), rows = vars(group), labeller = label_wrap_gen()) +
  geom_density() +
  geom_vline(data = attendance_rate_mean, aes(xintercept = mean), color = "red") +
  labs(title = "Attendance rates for Students in Conn.",
       x = "Attendance Rate",
       y = "Density") + 
  theme(strip.text.y.right = element_text(angle = 0))

```

-[] Include numerical and graphical summaries of the data. Be sure to introduce and describe your numerical and graphical summaries.  Do not display a series of summaries without text explaining them.
-[] Make sure to include at least one graphical display of the data that best supports your main conclusions for your primary question, and explain how it supports your conclusions.
-[] For each inference you make, briefly describe the method you use and what the results are.
-[] Provide evidence to support each of your claims.
-[] This section should not include substantial interpretation of results. Leave that for the discussion.

# Discussion

-[] Provide broader interpretations of your analysis and describe how to interpret your results with respect to your question of interest.
-[] Discuss any potential short-comings of the analysis.
-[] Discuss potential future directions for additional work
-[] New questions
-[] Different methods to address the same questions
-[] New data you might collect to refine your understanding
-[] Summarize your primary conclusions and the primary evidence that supports these conclusions.

# References

-[] In the R Markdown file, you may automatically cite other resources by using a caret followed by the reference between square brackets: ^[your reference text] which will place a marker at this location and a footnote at the end of the document.